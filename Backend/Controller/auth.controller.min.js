import User from"../Model/userDetails.model.js";import bcryptjs from"bcryptjs";import jwt from"jsonwebtoken";import{errorHandler}from"../Utils/error.js";const JWT_SECRET="pockeypeperoaj==12i3uppupsaudioahsdjnzpkmcdknhbv210312ie9qwusiadjlncshdbasgdcnahsxjkdsadma";export const register=async(req,res,next)=>{const{uname:uname,email:email,password:password}=req.body,hashPassword=bcryptjs.hashSync(password,10);try{const emailExist=await User.findOne({email:email});emailExist&&next(errorHandler(401,"Email Exist")),await User.create({username:uname,email:email,password:hashPassword}),res.send({status:"Account Register"})}catch(error){next(error)}};export const login=async(req,res,next)=>{const{email:email,password:password}=req.body;try{const user=await User.findOne({email:email});if(user||next(errorHandler(401,"No User Found")),bcryptjs.compareSync(password,user.password)){const accToken=jwt.sign({id:user._id},JWT_SECRET),{password:password,...rest}=user._doc;res.status(200)?res.cookie("access_token",accToken,{httpOnly:!0}).status(200).json(rest):next(errorHandler(401,"Invalid Creditial"))}}catch(error){next(error)}};