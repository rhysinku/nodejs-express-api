const express=require("express"),jwt=require("jsonwebtoken"),cors=require("cors"),mongoose=require("mongoose"),app=express();app.use(express.json()),app.use(cors());const JWT_SECRET="pockeypeperoaj==12i3uppupsaudioahsdjnzpkmcdknhbv210312ie9qwusiadjlncshdbasgdcnahsxjkdsadma",mongoUrl="mongodb+srv://rhysindodev:eOR1HJsCqGsWzVO7@cluster0.mqk2f9r.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0";require("./Model/userDetails");const User=mongoose.model("UserDetails");mongoose.connect(mongoUrl).then(()=>{console.log("Mongo Connected From Server")}).catch(e=>console.log(e)),app.listen(1234,()=>{console.log("Server is started: Port: 1234")}),app.post("/register",async(req,res)=>{const{uname:uname,email:email,password:password}=req.body;try{const emailExist=User.find({email:email});if(emailExist)return res.send({status:"Email already exists"});await User.create({uname:uname,email:email,password:password}),res.send({status:"Data Added"})}catch(error){res.send(error)}}),app.post("/login",async(req,res)=>{const{email:email,password:password}=req.body;try{const user=await User.findOne({email:email});if(!user)return res.send({status:"No User Found"});if(password===user.password){const accToken=jwt.sign({},JWT_SECRET);return res.status(200)?res.send({status:"Account Login",accToken:accToken}):res.send({status:"Incorrect Details",accToken:accToken})}}catch(error){return res.send(error)}});